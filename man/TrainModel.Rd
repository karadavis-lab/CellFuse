% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cellfuse_interface.R
\name{TrainModel}
\alias{TrainModel}
\title{Train CellFuse model using labeled reference data}
\usage{
TrainModel(
  dataset_name,
  data_dir,
  save_path,
  device,
  cluster_column,
  lr,
  margin,
  bs,
  epoch,
  k,
  min_delta,
  patience,
  val_step,
  output_dim,
  dropout_prob,
  activation_function,
  alpha
)
}
\arguments{
\item{dataset_name}{Name of the dataset (e.g., "Levine32")}

\item{data_dir}{Path to the reference dataset directory}

\item{save_path}{Path to directory where model and outputs will be saved}

\item{device}{Device to use ("cpu" or "cuda")}

\item{cluster_column}{Column name for cluster labels in metadata}

\item{lr}{Learning rate}

\item{margin}{Margin for contrastive loss}

\item{bs}{Batch size}

\item{epoch}{Number of training epochs}

\item{k}{K for KNN classifier}

\item{min_delta}{Minimum improvement for early stopping}

\item{patience}{Number of validation steps with no improvement before stopping}

\item{val_step}{Number of steps between validation checks}

\item{output_dim}{Dimension of embedding space}

\item{dropout_prob}{Dropout probability}

\item{activation_function}{Activation function (e.g., 'relu', 'leaky_relu')}

\item{alpha}{Weight for auxiliary loss or regularization term}
}
\value{
Invisibly returns \code{NULL}. The function writes the following outputs to
\code{save_path}:
\itemize{
\item Trained CellFuse model weights (saved under \code{Saved_model/})
\item Training and validation performance metrics
\item A PNG file containing training curves (loss and accuracy vs epoch)
\item Optional intermediate artifacts required for downstream prediction
}
}
\description{
#' @description
Trains a supervised contrastive learning model on a labeled reference
proteomics dataset to learn a shared embedding
space for downstream cross-modality cell type prediction.
}
\details{
The function uses a Python backend (via \pkg{reticulate}) to implement
supervised contrastive learning. The reference dataset must contain:
\itemize{
\item Rows corresponding to individual cells
\item Columns corresponding to protein markers
\item A column containing cell type labels (specified by \code{cluster_column})
}
The trained model, embeddings, and performance metrics are saved to
\code{save_path}, including a timestamped folder in
\code{Saved_model/}.

Model performance is visualized as training and validation loss and accuracy
across epochs and saved automatically to the specified output directory.
Early stopping is applied based on validation loss.
}
\examples{
\dontrun{
TrainModel(
  dataset_name = "CyTOF",
  data_dir = "Reference_Data/",
  save_path = "Predicted_Data/",
  device = "cpu",
  cluster_column = "cluster.orig"
)
}

}
